<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test Closed Positions Feature</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            padding: 20px;
        }
        .test-section {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #45a049;
        }
        .result {
            background: #1e1e1e;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>üîç Closed Positions Feature Test</h1>
    
    <div class="test-section">
        <h2>Feature Overview</h2>
        <p>The closed positions feature allows you to:</p>
        <ul>
            <li>‚úÖ View closed positions from the last 1-30 days</li>
            <li>‚úÖ See profit/loss for each closed position</li>
            <li>‚úÖ View position details (open/close prices, duration, swap, commission)</li>
            <li>‚úÖ See summary statistics (total P&L, win rate, number of trades)</li>
            <li>‚úÖ Switch between open and closed positions tabs</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>How to Use</h2>
        <ol>
            <li><strong>Connect to MT5:</strong> Click "Connect MT5" button in the main application</li>
            <li><strong>Switch to Closed Positions:</strong> Click the "Closed Positions" tab in the bottom panel</li>
            <li><strong>Select Time Range:</strong> Choose from 1 day to 30 days using the dropdown</li>
            <li><strong>Refresh Data:</strong> Click "Refresh" to load the latest closed positions</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>What You'll See</h2>
        <h3>Summary Statistics:</h3>
        <ul>
            <li><strong>Total P&L:</strong> Combined profit/loss of all closed positions</li>
            <li><strong>Trades:</strong> Total number of closed positions</li>
            <li><strong>Win Rate:</strong> Percentage of profitable trades</li>
            <li><strong>Winners/Losers:</strong> Count of profitable vs losing trades</li>
        </ul>
        
        <h3>Individual Position Details:</h3>
        <ul>
            <li><strong>Ticket:</strong> MT5 position ticket number</li>
            <li><strong>Symbol & Type:</strong> Trading pair and BUY/SELL direction</li>
            <li><strong>Volume:</strong> Position size</li>
            <li><strong>Open/Close Prices:</strong> Entry and exit prices</li>
            <li><strong>Duration:</strong> How long the position was open</li>
            <li><strong>Profit/Loss:</strong> Final P&L including swap and commission</li>
            <li><strong>Timestamps:</strong> When the position was opened and closed</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>Color Coding</h2>
        <ul>
            <li><span style="color: #4CAF50;">üü¢ Green:</span> Profitable positions</li>
            <li><span style="color: #f44336;">üî¥ Red:</span> Losing positions</li>
            <li><span style="color: #666;">‚ö´ Gray:</span> Breakeven positions</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>Technical Implementation</h2>
        <p>The feature works by:</p>
        <ul>
            <li>üì° Calling MT5's <code>history_deals_get()</code> API</li>
            <li>üîÑ Processing deal history to reconstruct closed positions</li>
            <li>üìä Calculating profit/loss including swap and commission</li>
            <li>üé® Displaying results in a user-friendly interface</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>Files Modified</h2>
        <ul>
            <li><strong>mt5_bridge.py:</strong> Added <code>get_closed_positions()</code> method</li>
            <li><strong>mt5-bridge.js:</strong> Added client-side API method</li>
            <li><strong>main.js:</strong> Added IPC handler</li>
            <li><strong>preload.js:</strong> Exposed API to renderer</li>
            <li><strong>renderer.js:</strong> Added UI logic and tab management</li>
            <li><strong>index.html:</strong> Added tabs and controls</li>
            <li><strong>styles.css:</strong> Added styling for new components</li>
        </ul>
    </div>

    <script>
        console.log('üéØ Closed Positions Feature Test Page Loaded');
        console.log('üìã To test the feature:');
        console.log('1. Open the main MT5 Strategy Builder application');
        console.log('2. Connect to MT5');
        console.log('3. Click the "Closed Positions" tab in the bottom panel');
        console.log('4. Select a time range and click "Refresh"');
    </script>
</body>
</html>