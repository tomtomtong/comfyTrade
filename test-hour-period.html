<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test Hour Period for Closed Positions</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            padding: 20px;
        }
        .test-section {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #45a049;
        }
        .result {
            background: #1e1e1e;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
    </style>
</head>
<body>
    <h1>üïê Hour Period Test for Closed Positions</h1>
    
    <div class="test-section">
        <h2>New Feature: Last Hour Period</h2>
        <p>The closed positions feature now supports showing positions from the last hour!</p>
        <ul>
            <li>‚úÖ Added "1 hour" option to the time period dropdown</li>
            <li>‚úÖ Updated backend to handle fractional days (0.04 days = ~1 hour)</li>
            <li>‚úÖ Improved time labels to show "hour" vs "hours" vs "days"</li>
            <li>‚úÖ Enhanced console logging for better debugging</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>How to Test</h2>
        <ol>
            <li><strong>Open the main application</strong> and connect to MT5</li>
            <li><strong>Go to Closed Positions tab</strong> in the bottom panel</li>
            <li><strong>Select "1 hour"</strong> from the dropdown</li>
            <li><strong>Click "Refresh"</strong> to load positions from the last hour</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>Time Period Options</h2>
        <ul>
            <li><strong>1 hour</strong> - Shows positions closed in the last 60 minutes</li>
            <li><strong>1 day</strong> - Shows positions closed in the last 24 hours</li>
            <li><strong>3 days</strong> - Shows positions closed in the last 3 days</li>
            <li><strong>7 days</strong> - Shows positions closed in the last week (default)</li>
            <li><strong>14 days</strong> - Shows positions closed in the last 2 weeks</li>
            <li><strong>30 days</strong> - Shows positions closed in the last month</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>Technical Implementation</h2>
        <p>The hour period works by:</p>
        <ul>
            <li>üìä Using fractional days: 0.04 days ‚âà 1 hour (1/24 ‚âà 0.042)</li>
            <li>üïê Python timedelta supports fractional days automatically</li>
            <li>üé® Smart time labels: "1 hour" vs "2 hours" vs "1 day" vs "2 days"</li>
            <li>üìù Enhanced logging shows proper time units</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>Test Time Label Function</h2>
        <button class="btn" onclick="testTimeLabels()">Test Time Labels</button>
        <div id="testResults" class="result"></div>
    </div>

    <script>
        // Test the time label function
        function getTimeLabel(daysBack) {
            if (daysBack < 1) {
                const hours = Math.round(daysBack * 24);
                return `${hours} hour${hours > 1 ? 's' : ''}`;
            } else {
                return `${daysBack} day${daysBack > 1 ? 's' : ''}`;
            }
        }

        function testTimeLabels() {
            const testCases = [
                0.04,   // 1 hour
                0.08,   // 2 hours
                0.5,    // 12 hours
                1,      // 1 day
                3,      // 3 days
                7,      // 7 days
                14,     // 14 days
                30      // 30 days
            ];

            let results = "Time Label Test Results:\n\n";
            
            testCases.forEach(value => {
                const label = getTimeLabel(value);
                const hours = value < 1 ? Math.round(value * 24) : null;
                results += `${value} days ‚Üí "${label}"`;
                if (hours) results += ` (${hours} hours)`;
                results += "\n";
            });

            document.getElementById('testResults').textContent = results;
            console.log('‚úÖ Time label test completed');
        }

        console.log('üïê Hour Period Test Page Loaded');
        console.log('üìã To test the new hour period feature:');
        console.log('1. Open the main MT5 Strategy Builder application');
        console.log('2. Connect to MT5');
        console.log('3. Go to Closed Positions tab');
        console.log('4. Select "1 hour" from the dropdown');
        console.log('5. Click "Refresh" to see positions from the last hour');
    </script>
</body>
</html>